<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cashfisch – v31 (größere Symbole, Glow, Glückwunsch-Text & Schlüssel)</title>
<link rel="stylesheet" href="./src/styles.css"/>
</head>
<body>
<div id="globalErr"></div>
<div id="bootToast">Boot: bereit…</div>

<!-- START SCREEN -->
<div id="startScreen">
  <div class="start-content">
    <div class="start-placeholder" role="img" aria-label="Titelbild der Cashfisch-Unterwasserwelt"></div>
    <button id="btnStartGame" class="btn primary start-btn" aria-label="Start Game">▶ Start Game</button>
  </div>
</div>

<!-- CHARACTER SELECT SCREEN -->
<div id="characterSelectScreen" style="display:none">
  <div class="character-select-content">
    <h2 class="character-select-title">Wähle deinen Charakter</h2>
    <div class="character-grid">
      <div class="character-card selected" data-character="player">
        <img src="./src/Player.png" alt="Standard Fisch" class="character-img">
        <span class="character-name">Standard Fisch</span>
      </div>
      <div class="character-card" data-character="pinkqualle">
        <img src="./src/Playerpinkqualle.png" alt="Pink Qualle" class="character-img">
        <span class="character-name">Pink Qualle</span>
      </div>
      <div class="character-card" data-character="kleinerdrache">
        <img src="./src/playerkleinerdrache.png" alt="Kleiner Drache" class="character-img">
        <span class="character-name">Kleiner Drache</span>
      </div>
      <div class="character-card" data-character="engelfisch">
        <img src="./src/Playerengelfisch.png" alt="Engelfisch" class="character-img">
        <span class="character-name">Engelfisch</span>
      </div>
    </div>
    <button id="btnConfirmCharacter" class="btn primary character-start-btn">▶ Spiel starten</button>
  </div>
</div>

<!-- GAME -->
<div id="gameWrap" style="display:none">
  <div id="endOverlay" class="end">
    <div class="endcard">
      <h2 id="endTitle">Glückwunsch! Du hast den Cashfisch besiegt und bist jetzt frei.</h2>
      <p>Was möchtest du tun?</p>
      <div class="endbtns">
        <button id="btnRestart" class="btn primary">🔁 Nochmal spielen</button>
        <button id="btnQuit" class="btn danger">◁ Beenden</button>
      </div>
    </div>
  </div>
  <canvas id="game" width="1200" height="675" class="frame"></canvas>
  <div class="banner" id="banner">Level 1: Schuldenbucht</div>
  <div id="pickupMsg" class="pickup"></div>
  <div class="hud">
    <div class="chip">
      <span>Score: <span id="score">0</span></span>
      <span>🪙 Münzen: <span id="coins">0</span></span>
      <span class="muted">⏱ <span id="time">0</span>s</span>
      <span id="hearts">❤❤❤</span>
      <span class="muted">Lvl <span id="lvl">1</span></span>
      <span class="xp-display" title="Erfahrungspunkte - Drücke U für Talentbaum">
        ⭐ Lv.<span id="playerLevel">1</span>
        <span class="xp-bar-mini">
          <span class="xp-bar-fill-mini" id="xpBarFill" style="width: 0%"></span>
        </span>
        <span class="skillpoints" id="skillPoints" style="display: none">+<span id="skillPointsNum">0</span>🎯</span>
      </span>
    </div>
    <div class="chip">
      <span class="abilities">
        <span class="ab" id="ab-bite" title="Angriff (Space/Linksklick)">🦷</span>
        <span class="ab locked" id="ab-shield" title="Schild (Shift/E)">🛡</span>
      </span>
      <span class="armor-indicator inactive" id="hudArmor" title="Rüstung der Meeresbewohner">🛡️</span>
      <span class="symbols">
        <span class="slot" id="sym-pferd" title="Schlüssel"></span>
        <span class="slot" id="sym-sprinter" title="Geldschein"></span>
        <span class="slot" id="sym-yacht" title="Yachtsymbol"></span>
      </span>
      <span class="tag">🛡 Unbesiegbar</span>
    </div>
  </div>
</div>
<!-- CUTSCENE -->
<div id="cutWrap" style="display:none">
  <canvas id="cutCanvas" width="1200" height="675" class="frame"></canvas>
  <aside id="cutInfo" class="cut-info" aria-label="Spielbeschreibung">
    <div class="cut-info-title">Spielsteuerung</div>
    <div class="cut-info-body">
      <ul>
        <li>Bewegung: WASD</li>
        <li>Angriff: Linke Maustaste – halten für Dauerfeuer</li>
        <li>Ab Level 2: Schild auf E</li>
        <li>Ab Level 3: Korallenbegleiter auf R</li>
        <li>Ab Level 4: Ultimate auf T (1 Aktivierung)</li>
      </ul>
    </div>
  </aside>
  <div class="hud">
    <button id="cutNext" class="btn">▶ Weiter</button>
  </div>
  <div class="btn" id="cutHint" style="position:fixed;left:50%;transform:translateX(-50%);bottom:14px;display:none">Cutscene Ende – Space/Klick startet das Spiel</div>
  <div class="name" style="position:fixed;top:64px;left:50%;transform:translateX(-50%);display:flex;gap:16px;opacity:.85;font-weight:700;color:#cfe4ff">
    <span style="background:#0b1320cc;border:1px solid rgba(255,255,255,.12);padding:4px 8px;border-radius:10px">📖 Erzähler</span>
    <span style="background:#0b1320cc;border:1px solid rgba(255,255,255,.12);padding:4px 8px;border-radius:10px">🎣 Spieler</span>
  </div>
</div>

<!-- CHARACTER SELECTION LOGIC -->
<script src="./src/ui/characterSelect.js"></script>

<script src="./src/error-display.js"></script>

<!-- DEBUG: Animation Test Key Listener -->
<script>
// Globale Variable für Animation-Test
window.ANIM_TEST = {
	enabled: false,
	animation: null,
	player: null
};

window.addEventListener('keydown', function(e) {
	if (e.key === 't' || e.key === 'T') {
		window.ANIM_TEST.enabled = !window.ANIM_TEST.enabled;
		console.log('[AnimTest] Animation:', window.ANIM_TEST.enabled ? 'AN' : 'AUS');
	}
});
</script>

<script type="module" src="./src/game.js"></script>

<!-- DEBUG: Grid Editor für begehbare Bereiche -->
<script src="./src/tools/gridEditor.js"></script>

<!-- CUTSCENE -->
<script src="./src/cutscene.js"></script>
</body>
</html>
